<!DOCTYPE html>
<html>
<head><title>Admin</title><link rel="stylesheet" href="style.css"></head>
<body>
  <h2>Admin Panel</h2>
  <h3>Create User</h3>
  <input id="newu" placeholder="Username">
  <input id="newp" type="password" placeholder="Password">
  <button onclick="create()">Create</button>
  <p id="res"></p>
  <h3>User List</h3>
  <ul id="list"></ul>
  <script>
    function refresh() {
      fetch("https://employee-salary-backend.onrender.com/api/admin/list-users")
        .then(r=>r.json()).then(data=>{
          list.innerHTML = "";
          data.forEach(u=>{
            const li = document.createElement("li");
            li.innerHTML = u.username + " — ";
            const d = document.createElement("input");
            d.type = "date"; d.value = u.salaryStatus.date || "";
            li.append(d);
            const c = document.createElement("input");
            c.type = "checkbox";
            c.checked = u.salaryStatus.isCredited;
            li.append(c);
            const btn = document.createElement("button");
            btn.innerText = "Set";
            btn.onclick = () => {
              fetch("https://employee-salary-backend.onrender.com/api/admin/set-salary",{
                method: "POST",
                headers: {'Content-Type':'application/json'},
                body: JSON.stringify({
                  username: u.username,
                  date: d.value,
                  isCredited: c.checked
                })
              }).then(r=>r.json()).then(()=>refresh());
            };
            li.append(btn);
            list.append(li);
          });
        });
    }
    function create() {
      fetch("https://employee-salary-backend.onrender.com/api/admin/create-user", {
        method:"POST",
        headers:{'Content-Type':'application/json'},
        body:JSON.stringify({ username: newu.value, password: newp.value })
      }).then(r=>r.json()).then(x=>{ res.innerText = x.message; refresh() });
    }
    refresh();
  </script>
</body>
</html>
<button onclick="toggleTheme()">Toggle Theme</button>
<script>
  function toggleTheme() {
    document.body.classList.toggle("dark");
  }
</script>
<button onclick="resetAll()">Reset All Data</button>
<script>
  function resetAll() {
    fetch("https://employee-salary-backend.onrender.com/api/admin/reset", { method: "POST" })
      .then(res => res.json()).then(msg => alert(msg.message));
  }
</script>
<input id="oldPass" type="password" placeholder="Old Password">
<input id="newPass" type="password" placeholder="New Password">
<button onclick="changePassword()">Change Password</button>
<body>
  <h2>Admin Panel</h2>
  <button onclick="logout()">Logout</button>
  <!-- other content -->

  <script>
    function logout() {
      sessionStorage.clear();
      location.href = "index.html"; // or "login.html"
    }
  </script>
</body>
<input type="text" placeholder="Username" id="username">
<input type="password" placeholder="Password" id="password">
<input type="text" placeholder="Role" id="role">
<input type="email" placeholder="Email" id="email">  ✅ ← user enters this!
<button onclick="createUser()">Create User</button>
<script>
  function createUser() {
    const username = document.getElementById("username").value;
    const password = document.getElementById("password").value;
    const role = document.getElementById("role").value;
    const email = document.getElementById("email").value;

    fetch("https://employee-salary-backend-url.onrender.com/api/admin/create-user", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password, role, email }),
    })
      .then((res) => res.json())
      .then((data) => {
        alert(data.message || "User created successfully");
      })
      .catch((err) => {
        console.error("Error:", err);
        alert("Error creating user");
      });
  }
</script>


